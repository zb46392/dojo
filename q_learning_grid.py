#!/usr/bin/env python3

from environment import TicTacToe as T
from agent import QLearning as Q, Random as R
from itertools import product
from time import time
from play import play


def main() -> None:
    x = (i / 10 for i in range(1, 10))
    y = (i / 10 for i in range(1, 10))

    hs = {}
    start = time()

    for combo in product(x, y):
        lr, gam = combo
        q = Q()
        q._learning_rate = lr
        q._gamma = gam
        r = R()

        wins, _ = play(q, r, nbr_of_games_to_print=0, should_print_info=False, should_agent1_train=True,
                       should_agent2_train=False, nbr_of_training=100000)
        hs[combo] = wins
    end = time()

    top = [k for k in hs.keys()]
    top.sort(key=lambda k: hs[k])

    print('  lr, gamma')
    for s in top:
        print(f'{s}: {hs[s]}')

    print(f'Elapsed time: {end - start}')


if __name__ == '__main__':
    main()

"""
  lr, gamma
(0.1, 0.1): 8219
(0.1, 0.3): 8924
(0.2, 0.1): 8934
(0.1, 0.5): 8939
(0.6, 0.9): 8962
(0.1, 0.6): 8994
(0.9, 0.6): 8997
(0.2, 0.2): 9001
(0.9, 0.8): 9012
(0.3, 0.1): 9021
(0.9, 0.5): 9029
(0.4, 0.1): 9030
(0.9, 0.1): 9030
(0.8, 0.2): 9035
(0.8, 0.1): 9058
(0.9, 0.7): 9065
(0.8, 0.6): 9070
(0.8, 0.3): 9072
(0.9, 0.3): 9080
(0.7, 0.6): 9082
(0.6, 0.1): 9084
(0.8, 0.7): 9086
(0.9, 0.9): 9101
(0.7, 0.8): 9103
(0.4, 0.3): 9105
(0.8, 0.8): 9105
(0.2, 0.3): 9109
(0.1, 0.2): 9113
(0.6, 0.3): 9113
(0.5, 0.2): 9115
(0.3, 0.4): 9117
(0.4, 0.9): 9118
(0.1, 0.4): 9120
(0.8, 0.9): 9120
(0.1, 0.9): 9122
(0.6, 0.2): 9122
(0.9, 0.2): 9122
(0.6, 0.4): 9123
(0.5, 0.5): 9132
(0.7, 0.3): 9136
(0.8, 0.5): 9137
(0.5, 0.9): 9140
(0.6, 0.5): 9140
(0.5, 0.7): 9141
(0.4, 0.5): 9143
(0.7, 0.9): 9143
(0.8, 0.4): 9144
(0.2, 0.4): 9145
(0.7, 0.5): 9147
(0.3, 0.2): 9149
(0.4, 0.2): 9153
(0.3, 0.5): 9155
(0.6, 0.7): 9157
(0.5, 0.1): 9158
(0.7, 0.4): 9160
(0.3, 0.3): 9165
(0.6, 0.6): 9167
(0.7, 0.7): 9168
(0.9, 0.4): 9173
(0.7, 0.1): 9174
(0.1, 0.8): 9175
(0.4, 0.8): 9175
(0.5, 0.4): 9178
(0.5, 0.6): 9183
(0.2, 0.8): 9191
(0.4, 0.7): 9194
(0.6, 0.8): 9197
(0.2, 0.7): 9200
(0.3, 0.8): 9201
(0.7, 0.2): 9201
(0.2, 0.6): 9203
(0.4, 0.4): 9208
(0.1, 0.7): 9213
(0.2, 0.5): 9214
(0.5, 0.3): 9215
(0.4, 0.6): 9224
(0.2, 0.9): 9230
(0.3, 0.6): 9231
(0.3, 0.7): 9236
(0.5, 0.8): 9238
(0.3, 0.9): 9264
Elapsed time: 6320.143301725388
"""